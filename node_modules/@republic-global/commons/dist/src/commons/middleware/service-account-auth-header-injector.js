import { configAuthLib, getServiceAccountToken, } from '@republic-global/auth-lib';
import { commonsConfig } from '../commons-config.js';
import { LoggerFactory } from '../utils/index.js';
const logger = LoggerFactory.getLogger('FetchAuthServiceAccountMiddleware');
configAuthLib(commonsConfig.authLib.serviceAccountToken);
export const serviceAccountAuthHeaderInjector = async (requestInit) => {
    logger.debug('Retrieving service account token...');
    const token = await getServiceAccountToken();
    logger.debug('Successfully retrieved service account token...');
    const headers = new Headers(requestInit.headers || {});
    headers.set('Authorization', `Bearer ${token}`);
    return {
        ...requestInit,
        headers: headers,
    };
};
//# sourceMappingURL=service-account-auth-header-injector.js.map