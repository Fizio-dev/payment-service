import { Passport } from 'passport';
import { crowdCraftJwtStrategy } from '../strategy/index.js';
const passport = new Passport();
passport.use(crowdCraftJwtStrategy);
export const jwtAuth = (req, res, next) => {
    passport.authenticate('jwt', { session: false })(req, res, next);
};
export const socketJwtAuth = (req, res, next) => {
    // only check during initial handshake http request
    const isHandshake = req._query['sid'] === undefined;
    if (isHandshake) {
        passport.authenticate('jwt', { session: false })(req, res, next);
    }
    else {
        next();
    }
};
//# sourceMappingURL=jwt-auth.js.map